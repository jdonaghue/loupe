<!DOCTYPE html>
<html>
	<head>
		<title>Pie Chart</title>
		<script src="../../Peppy/peppy.js"></script>
		<script src="../loupe.js"></script>
		<script src="pie.js"></script>
		<script>
			window.onload = function() {

				function rand(min, max) {
					return Math.round(min + Math.floor(Math.random() * (max - min)));
				}

				var data = [
						{ title: 'Jobs Rate', subtitle: 'USD millions', value: rand(10, 800) / 100 }, 
						{ title: 'Economy', subtitle: 'USD Trillions', value: rand(10, 600) / 100 }, 
						{ title: 'Basketball', subtitle: 'Points', value: rand(10, 1000) / 100 }, 
						{ title: 'Shoes', subtitle: 'Size', value: rand(100, 400) / 100 }, 
						{ title: 'Food', subtitle: 'Pizza', value: rand(10, 300) / 100 },
						{ title: 'Clothes', subtitle: 'Shirts', value: rand(10, 200) / 100 },
						{ title: 'Fruit', subtitle: 'Apples', value: rand(10, 400) / 100 },
						{ title: 'Cars', subtitle: 'BMW', value: rand(10, 100) / 100 }
					],
					opts = { reader: function(a) { return a }, replace: true },
					div = peppy.query('div');

				loupe('div')
					.pie({
						from: {
							d: 'M250,250L200,200A0,0,0,0,0,10,10z'
						},
						centerX: 250,
						centerY: 250,
						radius: 200,
						rainbow: true,
						animate: {
							animate_duration: 500
						},
						hoverBounce: { 
							offset: 10,
							duration: 100
						},
						events: {
							click: function(e, shape, data) {
								alert(shape._tag + data.value);
							},
							mouseover: function(e, shape, data) {
								var d = peppy.query('#infoPanel')[0];

								if (!d) {
									d = document.createElement('div');
									d.id = 'infoPanel';
								}

								d.innerHTML = [
									'<h4>',
										data.title,
									'</h4>',
									'<small>',
										data.subtitle,
									'</small>',
									'<br/><br/>',
									data.value
								].join('');
								peppy.query('div')[0].appendChild(d);
							},
							mouseout: function(e, shape, data) {

								var title = peppy.query('#infoPanel')[0];
								title.parentNode.removeChild(title);
							}
						}
					})
					.data(data, opts)
					.transform('linear')
					.draw({ animate_duration: 500 });
			}
		</script>

		<style type="text/css">
			body {
				font-family: "Helvetica Neue", Helvetica, sans-serif;
				padding-left: 70px;
			}

			h1 {
				font-size: 65px;
			}
			h4 {
				margin: 5px;
			}

			.container {
				width: 500px;
				height: 500px;
				border: 1px solid #ccc;
			}

			#infoPanel {
				width: 100px;
				height: 100px;
				border: 1px solid #000;
				background: #fff;
				position: fixed;
				text-align: center;
				left: 477px;
				top: 166px;
			}
		</style>
	</head>
	<body>	
		<h1>Pie Chart</h1>
		<div class="container"></div>
	</body>
</html>